# Copyright 2001-2013 Sourcefire, Inc. All Rights Reserved.
#
# This file contains (i) proprietary rules that were created, tested and certified by
# Sourcefire, Inc. (the "VRT Certified Rules") that are distributed under the VRT
# Certified Rules License Agreement (v 2.0), and (ii) rules that were created by
# Sourcefire and other third parties (the "GPL Rules") that are distributed under the
# GNU General Public License (GPL), v2.
# 
# The VRT Certified Rules are owned by Sourcefire, Inc. The GPL Rules were created
# by Sourcefire and other third parties. The GPL Rules created by Sourcefire are
# owned by Sourcefire, Inc., and the GPL Rules not created by Sourcefire are owned by
# their respective creators. Please see http://www.snort.org/snort/snort-team/ for a
# list of third party owners and their respective copyrights.
# 
# In order to determine what rules are VRT Certified Rules or GPL Rules, please refer
# to the VRT Certified Rules License Agreement (v2.0).
#
#-----------------
# OS-MOBILE RULES
#-----------------

alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"OS-MOBILE Apple iOS 6.x jailbreak download attempt"; flow:to_server,established; flowbits:isset,file.zip; file_data; content:"evasi0n-win-"; fast_pattern:only; content:"evasi0n.exe"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:url,evasi0n.com/; classtype:attempted-admin; sid:25616; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-MOBILE Apple iOS 6.x jailbreak download attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"evasi0n-win-"; fast_pattern:only; content:"evasi0n.exe"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:url,evasi0n.com/; classtype:attempted-admin; sid:25615; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-MOBILE Apple iOS 4.3.3 jailbreak for iPad download attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|28 69 90 CC 10 42 88 0A D9 21 25 52 F6 DE 23 23|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19417; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-MOBILE Apple iOS 4.3.3 jailbreak for iPad download attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|78 DA ED DD 07 5C 8E FB E3 3F FE 86 8C 86 A2 A1 41 32 22 69 A7 52 69 A2 D2 56 89 64 A5 BD 35 35|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19416; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-MOBILE Apple iOS 4.3.3 jailbreak for iPod download attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|78 DA ED DD 07 3C 97 FB FF 3F 7E 23 0D 23 CA C8 28 69 90 64 13 21 44 85 B2 0A 91 68 C8 DE 5B 46|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19419; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-MOBILE Apple iOS 4.3.3 jailbreak for iPhone download attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|78 DA ED DD 07 3C D7 7B FF 3F 7E 2A 29 15 1A 94 64 A5 32 B2 25 45 94 0A 89 22 85 64 25 7B CB DE|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19418; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android Gmaster device information send"; flow:to_server,established; content:"uid="; nocase; http_client_body; content:"imei="; nocase; http_client_body; content:"simNum="; nocase; http_client_body; content:"telNum="; nocase; http_client_body; content:"imsi="; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2011-082404-5049-99&tabid=2; classtype:trojan-activity; sid:26026; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android Tetus device information leakage variant"; flow:to_server, established; content:"User-Agent: Dalvik"; fast_pattern:only; http_header; content:"imei="; nocase; http_uri; content:"referrer="; nocase; http_uri; content:"pid="; nocase; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.virustotal.com/en/file/855332267ffd1fb671d916822ea2929bef8974441a34cb4d9eb9c9b60ba6481f/analysis/; classtype:trojan-activity; sid:26939; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android Tetus device information leakage"; flow:to_server, established; content:"User-Agent: Dalvik"; fast_pattern:only; http_header; content:"imei="; nocase; http_uri; content:"lpn="; nocase; http_uri; content:"vd="; nocase; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.virustotal.com/en/file/855332267ffd1fb671d916822ea2929bef8974441a34cb4d9eb9c9b60ba6481f/analysis/; classtype:trojan-activity; sid:26938; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android ANDR.Trojan.Opfake device information disclosure attempt"; flow:to_server,established; content:"/q.php"; nocase; http_uri; content:"Apache-HttpClient/UNAVAILABLE (java 1."; fast_pattern:only; http_header; content:"log"; depth:3; nocase; http_client_body; content:"Executing"; distance:0; nocase; http_client_body; content:"sendSMS"; distance:0; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,blog.avast.com/2012/10/31/double-trouble/; classtype:trojan-activity; sid:26827; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android ANDR.Trojan.Opfake credential theft attempt"; flow:to_server,established; content:"/login.php"; nocase; http_uri; content:"|28|Linux|3B| U|3B| Android 2."; fast_pattern:only; http_header; content:"user_id="; nocase; http_client_body; content:"&password="; distance:0; nocase; http_client_body; content:"&submit="; distance:0; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,blog.avast.com/2012/10/31/double-trouble/; classtype:trojan-activity; sid:26826; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-MOBILE Android ANDR.Trojan.ZertSecurity apk download"; flow:to_client,established; flowbits:isset,file.apk; file_data; content:"c|00|o|00|m|00|.|00|c|00|e|00|a|00|n|00|d|00|r|00|o|00|i|00|d|00|.|00|s|00|e|00|c|00|u|00|r|00|i|00|t|00|y|00|.|00|z|00|e|00|r|00|t"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:url,blog.lookout.com/blog/2013/05/06/zertsecurity; classtype:trojan-activity; sid:26795; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-MOBILE Android ANDR.Trojan.Opfake APK file download"; flow:to_client,established; file_data; flowbits:isset,file.apk; content:"n|00|g|00|j|00|v|00|n|00|p|00|s|00|l|00|n|00|p|00|.|00|i|00|p|00|l|00|h|00|m|00|k"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:url,www.virustotal.com/en/file/f2648dc7bc964dc7690c60575ad526ba5b23a0f09312fd7ebf4fa65a379919ca/analysis/; classtype:trojan-activity; sid:26783; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android Fakedoc device information leakage"; flow:to_server, established; content:"&locale_source_term_network_sim="; fast_pattern:only; http_uri; content:"network="; nocase; http_uri; content:"&did="; nocase; http_uri; content:"&model="; nocase; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.virustotal.com/en/file/85c4f3066b76671aab7148b98766e6b904c83cd0920187ec4bbd5af8c9e9c970/analysis/; classtype:trojan-activity; sid:26768; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android Fakeinst device information leakage"; flow:to_server, established; content:"Apache-HttpClient/UNAVAILABLE (java 1.4)|0D 0A|"; fast_pattern:only; http_header; content:"imei="; nocase; http_client_body; content:"imsi="; nocase; http_client_body; content:"msisdn="; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.virustotal.com/en/file/0a77e1aac4720037e2946edf84d957616e564bd525e444cf3994f5ae4b9374ab/analysis/; classtype:trojan-activity; sid:26761; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android Fakeinst device information leakage"; flow:to_server, established; content:"User-Agent: Dalvik/"; fast_pattern:only; http_header; content:"imei="; nocase; http_uri; content:"imsi="; nocase; http_uri; content:"phone="; nocase; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.virustotal.com/en/file/0a77e1aac4720037e2946edf84d957616e564bd525e444cf3994f5ae4b9374ab/analysis/; classtype:trojan-activity; sid:26760; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android Ewalls device information exfiltration"; flow:to_server, established; content:"uniquely_code="; fast_pattern:only; http_client_body; content:"imsi_mcc"; nocase; http_client_body; content:"build_model"; nocase; http_client_body; content:"line1_number"; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.virustotal.com/en/file/1318b052ac129baf53b004e2e4a7002f4bf8654c1dd9381c4cbf7a535b5c5106/analysis/; classtype:trojan-activity; sid:26705; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android Antammi device information exfiltration"; flow:to_server,established; content:"network_mcc"; fast_pattern:only; http_client_body; content:"imsi="; nocase; http_client_body; content:"phone_number="; nocase; http_client_body; content:"sim_id="; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.virustotal.com/en/file/10e2d89226c48d0d9fc08168cc5e508cd9afc6d08c262e70f02b7de607ef548a/analysis/; classtype:trojan-activity; sid:26693; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android Denofow phone information exfiltration"; flow:to_server,established; content:"SOAPAction: "; fast_pattern:only; http_header; content:"</opname>"; nocase; http_client_body; content:"</cell>"; nocase; http_client_body; content:"</openmic>"; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.virustotal.com/en/file/fc0417fd719f457f172a5c3fbb8fc155a04f2376b2ca4155395e01a028908038/analysis/; classtype:trojan-activity; sid:26689; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 30125 (msg:"OS-MOBILE Android MDK encrypted information leak"; flow:to_server,established; content:"Host: app.looking3g.com"; nocase; content:"/serv?"; nocase; content:"User-Agent: Apache-HttpClient/UNAVAILABLE (java 1.4)"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,androidmalwaredump.blogspot.com/2013/01/androidtrojmdk-aka-androidksapp.html; classtype:trojan-activity; sid:26443; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android MDK encrypted information leak"; flow:to_server,established; content:"Host: wap.juliu.net"; nocase; http_header; content:"/control.html?"; nocase; http_uri; content:"User-Agent: Apache-HttpClient/UNAVAILABLE (java 1.4)"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,androidmalwaredump.blogspot.com/2013/01/androidtrojmdk-aka-androidksapp.html; classtype:trojan-activity; sid:26442; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-MOBILE Android Stels server response"; flow:to_client,established; file_data; content:"{|22|removeAllSmsFilters|22|:"; fast_pattern:only; content:",|22|wait|22|:"; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.virustotal.com/en/file/03c1b44c94c86c3137862c20f9f745e0f89ce2cdb778dc6466a06a65b7a591ae/analysis/; classtype:trojan-activity; sid:26388; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android Stels initial server contact"; flow:to_server,established; content:"--AaB03x"; nocase; http_client_body; content:"Content-Disposition"; fast_pattern:only; nocase; http_client_body; content:"botId"; nocase; http_client_body; content:"imsi"; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.virustotal.com/en/file/03c1b44c94c86c3137862c20f9f745e0f89ce2cdb778dc6466a06a65b7a591ae/analysis/; classtype:trojan-activity; sid:26387; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5222 (msg:"OS-MOBILE Android Ksapp device registration"; flow:to_server,established; content:"/kspp/do?imei="; fast_pattern:only; nocase; http_uri; content:"&wid="; nocase; http_uri; content:"&type=&step=0"; nocase; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2012-091722-4052-99; classtype:trojan-activity; sid:26291; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android ANDR.Trojan.RootSmart outbound communication attempt"; flow:to_server,established; content:"c:root="; fast_pattern:only; http_client_body; content:"/androidService/services/AndroidService"; http_client_body; content:"IMEI"; distance:0; http_client_body; content:"&amp|3B|IMSI"; within:9; distance:16; http_client_body; content:"&amp|3B|TYPE_TEL"; within:18; distance:16; http_client_body; content:"INSTALL_TYPE"; distance:0; http_client_body; metadata:impact_flag red, policy balanced-ips drop, service http; reference:url,www.virustotal.com/en/file/8cb40e8dce05482907ff83b39911831daf20e4a69ee63a6cff523c880eed1acf/analysis/; classtype:trojan-activity; sid:26290; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"OS-MOBILE Android ANDR.Trojan.Chuli APK file download attempt"; flow:to_server,established; flowbits:isset,file.apk; file_data; content:"h|00|t|00|t|00|p|00|:|00|/|00|/|00|6|00|4|00 2E 00|7|00|8|00 2E 00|1|00|6|00|1|00 2E 00|1|00|3|00|3"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service smtp; reference:url,www.securelist.com/en/blog/208194186/Android_Trojan_Found_in_Targeted_Attack; classtype:trojan-activity; sid:26273; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-MOBILE Android ANDR.Trojan.Chuli APK file download attempt"; flow:to_client,established; flowbits:isset,file.apk; file_data; content:"h|00|t|00|t|00|p|00|:|00|/|00|/|00|6|00|4|00 2E 00|7|00|8|00 2E 00|1|00|6|00|1|00 2E 00|1|00|3|00|3"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:url,www.securelist.com/en/blog/208194186/Android_Trojan_Found_in_Targeted_Attack; classtype:trojan-activity; sid:26272; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android ANDR-WIN.MSIL variant PC-USB Malicious executable file download"; flow:to_server,established; pcre:"/\x2f[^\x26\x2f\x3f]+?\x2e(exe|zip)$/iU"; content:"Host|3A| claco."; fast_pattern:only; http_header; metadata:impact_flag red, service http; reference:url,www.securelist.com/en/blog/805/Mobile_attacks; classtype:trojan-activity; sid:26257; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"OS-MOBILE Android ANDR.Trojan.PremiumSMS APK file download attempt"; flow:to_server,established; flowbits:isset,file.apk; file_data; content:"c|00|o|00|m|00|.|00|z|00|w|00|x|00|.|00|f|00|l|00|y|00|a|00|p|00|p"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service smtp; reference:url,blog.trustgo.com/trojanextension-a-complex-malware-escapes-av-detection/; classtype:trojan-activity; sid:26247; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-MOBILE Android ANDR.Trojan.PremiumSMS APK file download attempt"; flow:to_client,established; flowbits:isset,file.apk; file_data; content:"c|00|o|00|m|00|.|00|z|00|w|00|x|00|.|00|f|00|l|00|y|00|a|00|p|00|p"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:url,blog.trustgo.com/trojanextension-a-complex-malware-escapes-av-detection/; classtype:trojan-activity; sid:26246; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android Fakenetflix email password upload"; flow:to_server,established; content:"Host|3A| erofolio.no-ip.biz"; fast_pattern:only; http_header; content:"email="; nocase; http_client_body; content:"&pass="; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2011-101105-0518-99&tabid=2; classtype:trojan-activity; sid:26205; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android CruseWind imei leakage"; flow:to_server,established; content:"/flash/test.xml?imei="; fast_pattern:only; http_uri; content:"&time="; nocase; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2011-070301-5702-99&tabid=2; classtype:trojan-activity; sid:26192; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android YZHC device registration"; flow:to_server,established; content:"action=domregbycode&"; fast_pattern:only; http_uri; content:"channe="; http_uri; content:"imsi="; http_uri; content:"code="; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.csc.ncsu.edu/faculty/jiang/YZHCSMS/; classtype:trojan-activity; sid:26190; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 9888 (msg:"OS-MOBILE Android YZHC device registration"; flow:to_server,established; content:"networklocale="; fast_pattern:only; content:"networkname="; content:"networkcode="; content:"register?imei="; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.csc.ncsu.edu/faculty/jiang/YZHCSMS/; classtype:trojan-activity; sid:26189; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android Zitmo trojan intercepted sms upload"; flow:to_server,established; content:"/security.jsp"; nocase; http_uri; content:"f0="; nocase; http_client_body; content:"&b0="; nocase; http_client_body; content:"&pid="; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,blog.fortinet.com/zitmo-hits-android/; classtype:trojan-activity; sid:26114; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android KMin imei imsi leakage"; flow:to_server,established; content:"/portal/m/c"; nocase; http_uri; content:".ashx?"; nocase; http_uri; content:"&nt2="; nocase; http_uri; content:"&tp=2"; nocase; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2011-093001-2649-99&tabid=2; classtype:trojan-activity; sid:26104; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android GoldDream device registration"; flow:to_server,established; content:"/zj/RegistUid.aspx?pid="; nocase; http_uri; content:"&imsi="; nocase; http_uri; content:"&imei="; nocase; http_uri; content:"&sim="; nocase; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.cs.ncsu.edu/faculty/jiang/GoldDream/; classtype:trojan-activity; sid:26102; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android GoneIn60Seconds data upload"; flow:to_server,established; content:"data="; nocase; http_client_body; content:"contacts%22%3a"; nocase; http_client_body; content:"sms%22%3a"; nocase; http_client_body; content:"recent%22%3a"; nocase; http_client_body; content:"url%22%3a"; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2011-093001-2649-99&tabid=2; classtype:trojan-activity; sid:26087; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android GGTracker installation call out"; flow:to_server,established; content:"/SM"; nocase; http_uri; content:"|3F|device_id="; nocase; http_uri; content:"|26|adv_sub="; nocase; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,blog.lookout.com/blog/2011/06/20/security-alert-android-trojan-ggtracker-charges-victims-premium-rate-sms-messages/; classtype:trojan-activity; sid:26018; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android GGTracker leak of device phone number"; flow:to_server,established; content:"notif.php?phone="; nocase; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,blog.lookout.com/blog/2011/06/20/security-alert-android-trojan-ggtracker-charges-victims-premium-rate-sms-messages/; classtype:trojan-activity; sid:26017; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android GGTracker server communication"; flow:to_server,established; content:"number="; nocase; http_client_body; content:"carrier="; nocase; http_client_body; content:"message="; nocase; http_client_body; content:"sdk="; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,blog.lookout.com/blog/2011/06/20/security-alert-android-trojan-ggtracker-charges-victims-premium-rate-sms-messages/; classtype:trojan-activity; sid:26016; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android Lovetrap initial connection"; flow:to_server,established; content:"positionrecorder.asmx"; nocase; http_uri; content:"imsi="; nocase; http_uri; content:"appid="; nocase; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2011-072806-2905-99&tabid=2; classtype:trojan-activity; sid:26015; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android ADRD encrypted information leak"; flow:to_server,established; content:".aspx?im="; nocase; http_uri; content:"User-Agent: Apache-HttpClient/UNAVAILABLE (java 1.4)"; fast_pattern:only; http_header; content:"Accept-Language: zh-CN, en-US"; nocase; http_header; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2011-072806-2905-99&tabid=2; classtype:trojan-activity; sid:25999; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android ADRD encrypted information leak"; flow:to_server,established; content:".aspx?im="; nocase; http_uri; content:"User-Agent: J2ME/UCWEB7.4.0.57"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2011-072806-2905-99&tabid=2; classtype:trojan-activity; sid:25998; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android jSMSHider initial encrypted device info send"; flow:to_server,established; content:"svs="; nocase; http_client_body; content:"sid="; nocase; http_client_body; content:"ssd="; nocase; http_client_body; content:"sta="; nocase; http_client_body; content:"sac="; nocase; http_client_body; content:"sci="; nocase; http_client_body; content:"sch="; nocase; http_client_body; content:"stp="; nocase; http_client_body; content:"svr="; nocase; http_client_body; content:"sig="; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,blog.lookout.com/blog/2011/06/15/security-alert-malware-found-targeting-custom-roms-jsmshider/; classtype:trojan-activity; sid:25997; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android.Trojan.Rus.SMS outbound communication attempt"; flow:established,to_server; content:"imei="; depth:5; http_client_body; content:"&time="; within:6; distance:15; http_client_body; content:"&os="; distance:0; http_client_body; content:"&imsi="; distance:0; http_client_body; content:"&v="; within:3; distance:15; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.virustotal.com/en/file/664725869278f478e5a50a5e359dc6d5cf4f2a7019d0c122e2fa1e318f19636b/analysis/; classtype:trojan-activity; sid:25868; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android AngryBirdsRioUnlocker initial device info send"; flow:to_server,established; content:"|22|userId|22 3A 22|NOT IN USE!!!|22|"; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.geek.com/articles/mobile/google-removes-malicious-angry-birds-apps-from-android-market-20110614/; classtype:trojan-activity; sid:25864; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android ANDR.Trojan.SMSsend variant outbound connection"; flow:established,to_server; content:"/rq.php"; http_uri; content:"Apache-HttpClient/UNAVAILABLE (java 1."; fast_pattern:only; http_header; content:"name="; depth:5; http_client_body; metadata:impact_flag red, policy security-ips drop, service http; reference:url,www.virustotal.com/file/2076cb718edae12fa641a6b28cc53aee8d9d495518836bcc24e8e8bd1172f892/analysis/; classtype:trojan-activity; sid:25512; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android/Fakelash.A!tr.spy trojan command and control channel traffic"; flow:to_server,established; content:"/data.php?action="; nocase; http_uri; content:"&m="; distance:0; nocase; http_uri; content:"&p="; distance:0; nocase; http_uri; content:"&n="; distance:0; nocase; http_uri; metadata:policy security-ips drop, ruleset community, service http; reference:url,blog.fortiguard.com/android-malware-distributed-by-malicious-sms-in-france/; classtype:trojan-activity; sid:24251; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-MOBILE Android SMSZombie APK file download"; flow:to_client,established; file_data; content:"assets/a33.jpg"; fast_pattern:only; flowbits:set,file.smszombie; flowbits:noalert; metadata:service http, service imap, service pop3; reference:url,blog.trustgo.com/SMSZombie/; classtype:trojan-activity; sid:23969; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-MOBILE Android SMSZombie APK file download attempt"; flow:to_client,established; flowbits:isset,file.apk; flowbits:isset,file.smszombie; file_data; content:"b|00|a|00|o|00|x|00|i|00|a|00|n|00|_|00|z|00|h|00|u|00|s|00|h|00|o|00|u"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:url,blog.trustgo.com/SMSZombie/; classtype:trojan-activity; sid:23954; rev:8;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android Zitmo trojan command and control channel traffic"; flow:to_server,established; content:"/update/biwdr.php"; fast_pattern:only; http_uri; metadata:policy security-ips drop, service http; reference:url,www.securelist.com/en/blog/208193604/Android_Security_Suite_Premium_New_ZitMo; classtype:trojan-activity; sid:23173; rev:4;)
# alert tcp $EXTERNAL_NET 2018 -> $HOME_NET any (msg:"OS-MOBILE Android/Nickispy.D sms logging response detection"; flow:to_client,established; content:"|00 00 00 27 00 80 00 05 80|"; depth:9; metadata:impact_flag red, policy security-ips drop; reference:url,www.virustotal.com/latest-report.html?resource=57f771d7809aa35599f81de9ea0120d3; classtype:trojan-activity; sid:21598; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 2018 (msg:"OS-MOBILE Android/Nickispy.D sms logging request detection"; flow:to_server,established; content:"|00 00 00 05 80|"; depth:5; offset:4; metadata:impact_flag red, policy security-ips drop; reference:url,www.virustotal.com/latest-report.html?resource=57f771d7809aa35599f81de9ea0120d3; classtype:trojan-activity; sid:21597; rev:3;)
# alert tcp $EXTERNAL_NET 2018 -> $HOME_NET any (msg:"OS-MOBILE Android/Nickispy.D initialization response detection"; flow:to_client,established; content:"|00 00 00 27 00 80 00 09 80|"; depth:9; metadata:impact_flag red, policy security-ips drop; reference:url,www.virustotal.com/latest-report.html?resource=57f771d7809aa35599f81de9ea0120d3; classtype:trojan-activity; sid:21596; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 2018 (msg:"OS-MOBILE Android/Nickispy.D initialization request detection"; flow:to_server,established; content:"|00 00 00 27 00 00 00 09 80|"; depth:9; metadata:impact_flag red, policy security-ips drop; reference:url,www.virustotal.com/latest-report.html?resource=57f771d7809aa35599f81de9ea0120d3; classtype:trojan-activity; sid:21595; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-MOBILE Android AnserverBot initial contact"; flow:to_server,established; content:"/jk.action?a="; fast_pattern:only; nocase; http_uri; content:"&key="; nocase; http_uri; content:"&g1="; nocase; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.csc.ncsu.edu/faculty/jiang/AnserverBot/; classtype:trojan-activity; sid:27016; rev:1;)
